#!/usr/bin/env bash

export PROJECT_NAME=franlara.cv
export XDEBUG_HOST=$(ifconfig | sed -En 's/127.0.0.1//;s/.*inet (addr:)?(([0-9]*\.){3}[0-9]*).*/\2/p' | head -n 1)

if [ $# -gt 0 ]; then

    if [[ "$1" == "start" ]]; then
        docker compose up -d

    elif [[ "$1" == "stop" ]]; then
        docker compose down

    elif [[ "$1" == "build" ]]; then
        docker compose up -d --build

    elif [[ "$1" == "npm" ]]; then
        shift 1
        docker compose exec ${PROJECT_NAME} npm "$@"

    elif [[ "$1" == "node" ]]; then
        shift 1
        docker compose exec ${PROJECT_NAME} node "$@"

    elif [[ "$1" == "compile" ]]; then
        docker compose exec ${PROJECT_NAME} npm run build

    elif [[ "$1" == "composer" ]]; then
        shift 1
        docker compose exec ${PROJECT_NAME} composer "$@"

    elif [[ "$1" == "artisan" ]]; then
        shift 1
        docker compose exec ${PROJECT_NAME} php artisan "$@"

    elif [[ "$1" == "test" ]]; then
        shift 1
        docker compose exec ${PROJECT_NAME} php artisan test "$@"

    fi

else
    docker compose ps
fi
